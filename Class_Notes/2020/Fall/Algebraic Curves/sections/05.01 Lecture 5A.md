# Lecture 5A 

We saw an interesting example of a function field in more than one variable which showed that valuations of rank larger than 1 can arise, but this does not happen for one variable function fields.
That is, for $K/k$ of transcendence degree 1, all valuations on $K$ which are trivial on $k$ are discrete.
We'll now want to go farther and describe the places $\Sigma(K/k)$, which will be the set of points on an algebraic curve.
Scheme-theoretically, this will literally be the set of closed points on a certain projective curve whose function field is $K$.
Note that a priori, finding closed points on a curve over an arbitrary field is hard!

Recall that if $A$ is a Dedekind domain such that $\ff(A) = K$, then for all $\mathfrak{p}\in \mspec(A)$ there exists a discrete valuation $v_p$ on $K$.
I.e., every maximal ideal induces a discrete valuation that is $A\dash$regular, so the valuation ring will contain $A$.
How is this obtained?
Take a nonzero $x\in K\units$, and take the corresponding principal fractional ideal $\gens{x} \da Ax$, which we can factor in a Dedekind domain as $Ax = \prod_{\mathfrak{p} \in \mspec(A)} \mathfrak{p}^{\alpha_{\mathfrak{p}}}$ with $\alpha_{\mathfrak{p}} \in \ZZ$.
This looks like an infinite product, but for any fixed $x$, only finitely many $\alpha$ are nonzero.
Note that these $\alpha$ are exactly what we're looking for: the $\mathfrak{p}\dash$adic evaluation of $x$ is given precisely by $v_{\mathfrak{p}}(x) \da \alpha_{\mathfrak{p}}$, where we are using unique factorization of ideals in Dedekind domains.
Thus we have a map
\[  
v_{\wait}: \mspec(A) &\to \Sigma(K/A) \\
\mathfrak{p} &\mapsto v_{\mathfrak{p}}
.\]

So this sends a maximal ideal to a place that is $A\dash$regular, and it turns out to be a bijection.

:::{.proposition title="?"}
The map $v$ is a bijection, and thus we may write
\[  
\Sigma(K/A) \cong \mspec(A)
.\]
:::

:::{.proof title="?"}
:::{.claim}
$v$ is injective.
:::
If $\mathfrak{p}_1, \mathfrak{p}_2 \in \mspec(A)$ are two different maximal ideals.
Then there exists an element $x\in \mathfrak{p}_1 \sm \mathfrak{p}_2$, and so $x^{-1} \in A_{\mathfrak{p}_2} \sm A_{\mathfrak{p}_1}$.
This follows since if $x$ is not in $\mathfrak{p}_2$, its $\mathfrak{p}_2\dash$adic valuation is zero, and thus the $\mathfrak{p}_2\dash$adic valuation of $x^{-1}$ is $-0 = 0$ as well.
On the other hand, since $x\in \mathfrak{p}_1$, its $\mathfrak{p}_1\dash$adic valuation is positive and therefore $v_{\mathfrak{p}_1}(x^{-1}) < 0$ and $x^{-1}$ is not in $A_{\mathfrak{p}_1}$.

:::{.claim}
$v$ is surjective.
:::
Let $v\in \Sigma(K/A)$, so $A \subset R_v$, i.e. take a valuation whose valuation ring contains $A$.
Note that we're not assuming the valuation is discrete, this can be a general Krull valuation, but we're trying to show it's equal to a certain $p\dash$adic valuation.
As always with a subring of a valuation ring, we can pull back the maximal ideal and consider $\mathfrak{m}_v \intersect A \in \spec(A)$.
We're hoping that this is a maximal ideal, since maximals correspond to valuations.
Since we're in a Dedekind domain, the only prime ideal we *don't* want this to be is the zero ideal of $A$, so suppose it were.
Then $A\nonzero \subset R_v\units$, and so $K\units \subset R_v\units$.
This is because the only element of the maximal ideal that lies in $A$ is zero, so every nonzero element of $A$ is not in this maximal ideal and is thus a unit.
But for any unit, its inverse is also a unit, yielding the inclusion $K\units \subset R_v\units$.
The only way this could possibly happen is if $R_v = K$, which yields the trivial valuation ring.
However, by definition, in $\Sigma(K/A)$ we've excluded the trivial valuation, so this ideal can not be zero.
\

So we can conclude that the pullback $\mathfrak{m}_v \intersect A \in \mspec(A)$, and so $A_{\mathfrak{p}} \subset R_v$.
This is from viewing elements in $A_{\mathfrak{p}}$ as quotients of elements in $A$ whose denominator have $\mathfrak{p}\dash$adic valuation zero.
Recall that we want to show that $R_v = A_{\mathfrak{p}}$.
We know $R_v \subset K$ is a proper containment, and we can use the fact that a *discrete* valuation ring is maximal among all proper subrings of its fraction field.
In other words, for $R$ a DVR, there is no ring $R'$ such that $R \subset R' \subset \ff(R)$.
How do you prove this?
This is similar to an early exercise in commutative algebra, where we looked at all rings between $\ZZ$ and $\QQ$, which generalized to looking at all rings between a PID and its fraction field, and a DVR is a local PID.
So proving this statement is actually easier.
\

This is enough to show that $A_{\mathfrak{p}} = R_v$, and this $v\sim v_{\mathfrak{p}}$.
:::

:::{.remark}
What the idea?
For a general one variable function field $K/k$, we'll produce affine Dedekind domains $R$ with $k \subset R \subset K$ and $\ff(R) = K$.
This will give is subrings of this full ring of places that are $\mspec$ of Dedekind domains.
How many such domains will we need for their union to be the entire set of places?
Just one won't work, since $\Sigma(K/k)$ is like a complete or projective object, and a projective variety of dimension 1 can't be covered by a single affine variety.
However, it turns out that you can always cover it with 2.
In fact, if you take any Dedekind domain between $k$ and $\ff(K)$, the set of missing places (the ones that aren't regular for any of these domains) will be a nonempty finite set of places.
So you can always cover it by finitely many, and two suffices: as a consequence of the Riemann-Roch theorem, after removing any nonempty finite set of places, you'll have the $\mspec$ of a canonically associated Dedekind domain.
We'll prove this by starting with the case of $K = k(t)$.
:::

:::{.claim}
\[  
\abs{ \Sigma(k(t)/k) \sm \mspec k[t] } = 1
.\]
:::

Note that $k \subset k[t] \subset k(t)$ and $k[t]$ is a Dedekind domain, so this fits into the above framework, and moreover we know the maximal ideals of polynomial rings: irreducible monic polynomials.
Taking all of these misses exactly one place.
How do we describe this missing place?

Suppose $v \in \Sigma(k(t) / k) \sm  \Sigma(k(t) / k[t])$, so the valuation ring of $v$ contains $k$ but does not contain $k[t]$.
Then the valuation ring can not contain $t$, and thus $v(t) < 0$ and $v(1/t) = -v(t) > 0$.
Since $k[1/t]$ is a PID, so if the valuation wasn't $t
dash$regular, it's $1/t\dash$regular by definition.
So $v\in \Sigma(k(t) / k[1/t])$.
Note that $k[1/t] \cong k[t]$ as rings.
How many valuations on this polynomial ring give positive valuation to $1/t$? 
Exactly one, since this corresponds to a prime ideal, namely $\gens{1/t}$, so this unique valuation is $v = v_{1 \over t}$, the $1/t\dash$adic valuation.

That is, if we write $f\in k(t)$ as $(1/t)^n a(1/t)/b(1/t)$ with $a, b\in k[t]$ polynomials with nonzero constant terms, then $v_{1\over t}(f) = n$.
Note that this process is the same as the one used to compute the $t\dash$adic valuation $v_t$.

Recall that a valuation on a domain can be uniquely extended to its fraction field by setting $v(x/y) = v(x) - v(y)$.

:::{.exercise title="?"}
Define $v_\infty: k(t)\units \to \ZZ$ by $p(t)/q(t) \mapsto \deg q - \deg p$.

a. Show $v_ \infty \in \Sigma(k(t) / k[1/t])$.

b. Show $v_ \infty \sim v_{1\over t}$ by showing they have the same valuation ring.

c. Show that $v_ \infty = v_{1\over t}$.

::: 

Note that $1/t$ is a uniformizer for $v_ \infty$

:::{.theorem title="Complete description of places"}
\[  
\Sigma(k(t) / k) = \mspec k[t] \disjoint \ts{v_ \infty}
.\]
:::

Note that we know the maximal ideals -- the irreducible monic polynomials -- but it takes some effort to write them down.
If $k$ is algebraically closed, however, every such polynomial is linear of the form $t-\alpha$ for $\alpha\in k$.
In this case, $\mspec k(t) \cong k$, and so $\sigma( \bar k (t) / \bar k) = \bar k \disjoint \ts{\infty} = \PP^1(\bar k)$.
More generally, the set of places on a rational function field will yield the scheme-theoretic set of closed points on the projective line over $k$, which is more complicated if $k\neq \bar k$ since not all closed points are $k\dash$rational.
Another way to say this is that if you have a valuation, there is a residue field, and for any place on a one variable function field the residue field will be a finite degree extension of $k$.
The degree 1 points will be the $k\dash$rational points, and so $\Sigma(k(t) / k)$ will always contain a copy of $k$ but may have closed points of larger degree, making things slightly more complicated.
This complication is handled well in both the scheme-theoretic and this valuation-theoretic approach.


The next theorem is a fact from commutative algebra:

:::{.theorem title="?"}
Let $A$ be a domain with $\ff(A) = K$.
Suppose $A$ is a finitely generated $k\dash$algebra, let $L/K$ be a finite degree field extension, and let $B$ be the integral closure of $A$ in $L$.
Then

a. $B$ is finitely generated as an $A\dash$module.

b. $B$ is an integrally closed domain with $\ff(B) = L$ which is finitely generated as a $k\dash$algebra.

c. $\dim A = \dim B$.

d. If $A$ is Dedekind, so is $B$.

\begin{tikzcd}
	{B} && {L} \\
	\\
	{A} && {K} \\
  \\
  {k}\ar[u]
	\arrow[from=3-1, to=1-1, hook]
	\arrow[from=3-3, to=1-3, hook]
	\arrow[from=1-1, to=1-3, hook, "\subset"]
	\arrow[from=3-1, to=3-3, hook, "\subset"]
\end{tikzcd}


:::

