# Thursday, October 01

Recall that a sheaf of rings on a topological space $X$ is a ring $\mathcal{F}(U)$ for all open sets $U\subset X$ satisfying four properties:

1. The empty set is mapped to zeor.

2. The morphism $\mathcal{F}(U)\to \mathcal{F}(U)$ is the identity.

3. Given $W\subset V\subset U$ we have
<!--\begin{center}-->
<!--\begin{tikzcd}-->
<!--\mathcal{F}(U) \ar[rd] & & \mathcal{F}(V) \ar[ld] \\-->
<!--& \mathcal{F}(W) &-->
<!--\end{tikzcd}-->
<!--\end{center}-->

4. Gluing: given sections $s_i \in\mathcal{F}(U_i)$ which agree on overlaps (restrict to the same function on $U_i\intersect U_j$), there is a unique $s\in \mathcal{F}(\union U_i)$.

:::{.example}
If $X$ is an affine variety with the zariski topology, $\mathcal{O}_X$ is a sheaf of regular functions, where we recall $\mathcal{O}_X(U)$ are the functions $\phi: U\to k$ that are locally a fraction.
:::

Recall that the *stalk* of a sheaf $\mathcal{F}$ at a point $p\in X$, is defined as 
\[  
\mathcal{F}_p \da \ts{(U, \phi) \st p\in U \text{ open },\, \phi \in \mathcal{F}(U)}/\sim
.\]
where $(U, \phi) \sim (U', \phi')$ if there exists a $p\in W \subset U\intersect U'$ such $\phi, \phi'$ restricted to $W$ are equal.

Recall that a *local ring* is a ring with a unique maximal ideal $\mfm$.
Given a prime ideal $\mfp \in R$, so $ab\in \mfp \implies a,b\in \mfp$, the complement $R\setminus P$ is closed under multiplication.
So we can localize to obtain $R_\mfp = \ts{a/s \st s\in R\setminus P, a\in R}/\sim$ where $a'/s' \sim a/s$ iff there exists a $t\in R\sm P$ such that $t(a's - as') = 0$.

:::{.warning}
Note that $R_f$ is localizing at the powers of $f$, whereas $R_\mfp$ is localizing at the *complement* of $\mfp$.
:::

Since maximal ideals are prime, we can localize any ring $R$ at a maximal ideal $R_\mfm$, and this will be a local ring.
Why?
The ideals in $R_\mfm$ biject with ideals in $R$ contained in $\mfm$.
Thus all ideals in $R_\mfm$ are contained in the maximal ideal generated by $\mfm$, i.e. $\mfm R_\mfm$.

:::{.lemma title="?"}
Let $X$ be an affine variety.
The stalk of the sheaf of regular functions $\OO_{X, p} \da (\OO_X)_p$ is isomorphic to the localization $A(X)_{\mfm_p}$ where $\mfm_p \da I(\ts{p})$.
:::

:::{.proof}
We can write
\[  
A(X)_{\mfm_p} \da \ts{{g\over f} \st g\in A(X),\, f\in A(X)\sm \mfm_p} / \sim \\
\text{ where } g_1/f_1 \sim g_2/f_2 \iff \exists h(p) \neq 0 \text{ where }0 = h(f_2 g_1 - f_1 g_2)
.\]
where the $f$ are regular functions on $X$ such that $f(p) = 0$.

We can also write
\[  
\OO_{X, p} \da \ts{(U, \phi) \st p\in U,\, \phi \in \OO_X(U) } /\sim 
\\ \text{ where } (U, \phi) \sim (U', \phi') 
\iff \exists p\in W \subset U\intersect U' \text{ s.t. } \ro{\phi}{W} = \ro{\phi'}{W}
.\]

So we can define a map
\[  
\Phi: A(X)_{\mfm_p} &\to \OO_{X, p} \\
{g\over f} &\mapsto (D_f, {g\over f})
.\]

**Step 1:**
There are equivalence relations on both sides, so we need to check that things are well-defined.

We have
\[  
g/f \sim g'/f' &\iff \exists g \text{ such that } h(p) \neq 0,\, h(gf' - g'f)=0 \in A(X) \\
&\iff \text{the functions } {g\over f}, {g' \over f'} \text{ agree on } W\da D(f) \intersect D(f') \intersect D(h) \\
&\implies (D_f, g/f) \sim (D_{f'}, g'/f')
,\]
since there exists a $W\subset D_f \intersect D_{f'}$ such that $g/f, g'/f'$ are equal.
\

**Step 2:**
Surjectivity, since this is clearly a ring map with pointwise operations.

Any germ can be represented by $(U, \phi)$ with $\phi \in \OO_X(U)$.
Since the sets $D_f$ form a base for the topology, there exists a $D_f\subset U$ containing $p$.
By definition, $(U, \phi) = (D_f, \ro{\phi}{D_f})$ in $\OO_{X, p}$.

Using the proposition that $\OO_X(D(f)) = A(X)_f$, this implies that $\ro{\phi}{D_f} = g/f^n$ for some $n$ and $f(p) \neq 0$, so $(U, \phi)$ is in the image of $\Phi$.
\

**Step 3**:
Injectivity.
We want to show that $g/f\mapsto 0$ implies that $g/f = 0 \in A(X)_{\mfm_p}$.

Suppose that $(D_f, g/f) = 0 \in \OO_{X, p}$ and $(U, \phi) = 0 \in \OO_{X,p}$, then there exists an open $W\subset D_f$ containing $p$ such that $\ro{\phi}{W} = \ro{0}{W} =0$.
Wlog we can assume $\phi = 0$ on $U$, since we could shrink $U$ (staying in the same equivalence class) to make this true otherwise.

Then $\phi = g/f$ on $D_f$, using that $\OO_X(D_f) = A(X)_f$, so $g/f = 0$ here.
So there exists a $k$ such that $f^k(g\cdot 1 - 0\cdot f) = 0$ in $A(X)$, so $f^k g=0$.

:::


