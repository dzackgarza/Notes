---
title: CRAG 
subtitle: The Weil Conjectures 
author: D. Zack Garza
date: April 2020
theme: Berkeley 
colortheme: default 
fontfamily: noto-sans
aspectratio: 169
header-includes:
- \usepackage{cmbright}
- \usepackage{caption}
fontsize: 9pt
---



# Background: Generating Functions

## Varieties 

Fix $q$ a prime and $\FF \definedas \FF_q$ the (unique) finite field with $q$ elements, along with its (unique) degree $n$ extensions 
$$
\FF_{q^n} = \theset{x\in \bar \FF_q \suchthat x^{q^n} - x = 0} \quad \forall~ n\in \ZZ^{\geq 2}
$$ 

Definition (Projective Algebraic Varieties)
:  Let $J = \gens{f_1, \cdots, f_M} \normal k[x_0, \cdots, x_n]$
    be an ideal, then a *projective algebraic* variety $X\subset \PP^n_\FF$ can be described as 
    $$
    X = V(J) = \theset{\vector{x} \in \PP^n_\FF \suchthat f_1(\vector x) = \cdots = f_M(\vector x) = \vector 0}
    $$
    where $J$ is generated by *homogeneous* polynomials in $n+1$ variables, i.e. there is a fixed $d = \deg f_i \in \ZZ^{\geq 1}$ such that 

    \begin{align*}
    f(\vector x) = \sum_{\substack{\vector I = (i_1, \cdots, i_n) \\ \sum_j i_j = d}} \alpha_{\vector I} \cdot x_0^{i_1}\cdots x_n^{i_n} 
    \qtext{ and } f(\lambda \cdot \vector x) = \lambda^d f(\vector x), \lambda \in \FF\units
    .\end{align*}


## Point Counts

- For a fixed variety $X$, we can consider its $\FF\dash$points $X(\FF)$.
  - Note that $\# X(\FF) < \infty$ is an integer
- For any $L/\FF$, we can also consider $X(L)$
  - In particular, we can consider $X(\FF_{q^n})$ for any $n\geq 2$.
  - We again have $\# X(\FF_{q^n}) < \infty$ and are integers for every such $n$.
- So we can consider the sequence

\begin{align*}
[N_1, N_2, \cdots , N_n, \cdots ] \definedas [\# X(\FF), ~ \#X (\FF_{q^2}), \cdots, ~\# X(\FF_{q^n}), \cdots]
.\end{align*}

- Idea: associate some generating function (a formal power series) encoding sequence, e.g. $$F(z) = \sum_{n=1}^\infty N_n z^n = N_1z + N_2 z^2 + \cdots .$$

## Why Generating Functions?

Note that for such an ordinary generating functions, the coefficients are related to the real-analytic properties of $F$: we can easily recover the coefficients in the following way:
\begin{align*}
[z^n] \cdot F(z) = [z^n]\cdot T_{F, z=0}(z) = \frac{1}{n!} \qty{\dd{}{z}}^{n} F(z) \Bigg\rvert_{z = 0} = N_n
.\end{align*}

They are also related to the complex analytic properties: using the Residue theorem, 
\begin{align*}
[z^n] \cdot F(z) \definedas \frac{1}{2\pi i} \oint_{\SS^1} {F(z) \over z^{n+1}}~dz = \frac{1}{2\pi i} \oint_{\SS^1} \frac{N_n}{z} ~dz = N_n
.\end{align*}

> The latter form is very amenable to computer calculation.

## Why Generating Functions?

An OGF is an infinite series, which we can interpret as an analytic function $\CC\to \CC$ -- in nice situations, we can hope for a closed-form representation.

A useful example: by integrating a geometric series we can derive
\begin{align*}
{1 \over 1-z} 
&= \sum_{n=0}^\infty z^n  
\hspace{5em} \qty{ = 1 + z + z^2 + \cdots} \\
\implies \int {1 \over 1-z} 
&= \int \sum_{n = 0}^\infty z^n \\
&= \sum_{n=0}^\infty \int z^n \quad{for } \abs{z} <  1 \qtext{by uniform convergence} \\
&= \sum_{n=0}^\infty \frac{1}{n+1}z^{n+1} 
\\
\implies -\log\qty{1-z} 
&= \sum_{n=1}^\infty {z^n \over n}  
\hspace{5em} \qty{= z + {z^2 \over 2} + {z^3 \over 3} + \cdots} 
.\end{align*}
For completeness, also recall that 
$$
\exp(z) \definedas \sum_{n=0}^\infty {z^n \over n!}
$$

# Zeta Functions

## Definition: Local Zeta Function

Problem: count points of a (smooth?) projective variety $X/\FF$ in all (finite) degree $n$ extensions of $\FF$.

Definition (Local Zeta Function)
:   The *local zeta function* of an algebraic variety $X$ is the following formal power series:

    \begin{align*}
    Z_X(z) &= \exp\qty{ \sum_{n=1}^\infty N_n {z^n \over n} } \in \QQ[[z]] \qtext{where} N_n \definedas \# X(\FF_n)
    .\end{align*}

Note that
\begin{align*}
z \qty{\dd{}{z}} \log Z_X(z) 
&= z \dd{}{z} \qty{N_1z + N_2 {z^2 \over 2} + N_3 {z^3 \over 3} + \cdots}  \\
&= z \qty{N_1 + N_2 z +  N_3 z^2 + \cdots } \hspace{5em} \text{(unif. conv.)}\\
&= N_1 z + N_2 z^2 + \cdots
= \sum_{n=1}^\infty N_n z^n 
,\end{align*}
which is an *ordinary* generating function for the sequence $(N_n)$.

# Examples

## Example: A Point

Take $X = \pt = V(\theset{f(x) = 0})/\FF$ a single point over $\FF$, then 
\begin{align*}
\#X(\FF_q) &\definedas N_1 = 1 \\
\#X(\FF_{q^2}) &\definedas N_2 = 1 \\
&\vdots \\
\#X(\FF_{q^n}) &\definedas N_n = 1 \\
&\vdots
.\end{align*}

and so 
\begin{align*}
Z_\pt(z) 
&= \exp\qty{ 1\cdot z + 1 \cdot {z^2 \over 2} + 1 \cdot {z^3 \over 3} + \cdots } \\
&= \exp\qty{\sum_{n=1}^\infty {{z}^n \over n} }  \\
&= \exp\qty{ -\log\qty{1-z} } \\
&= {1 \over 1 - z} 
.\end{align*}


> Notice: $Z$ admits a closed form **and** is a rational function.

## Example: The Affine Line

Take $X = \AA^1/\FF$ the affine line over $\FF$, then
We can write 
$$
\AA^1(\FF_{q^n}) = \theset{\vector x = [x_1] \suchthat x_1 \in \FF_{q^n}}
$$ 
as the set of one-component vectors with entries in $\FF_n$, so
\begin{align*}
X(\FF_q) &= q \\
X(\FF_{q^2}) &= q^2 \\
&\vdots \\
X(\FF_{q^n}) &= q^n
.\end{align*}

Then
\begin{align*}
Z_X(z) 
&= \exp\qty{\sum_{n=1}^\infty q^n {z^n \over n} }  \\
&= \exp\qty{\sum_{n=1}^\infty {\qty{qz}^n \over n} }  \\
&= \exp(-\log(1 - qz)) \\
&= \frac 1 {1 - qz}
.\end{align*}



## Example: Affine m-space

Take $X = \AA^m/\FF$ the affine line over $\FF$, then
We can write 
$$
\AA^m(\FF_{q^n}) = \theset{\vector x = [x_1, \cdots, x_m] \suchthat x_i \in \FF_{q^n}}
$$ 
as the set of one-component vectors with entries in $\FF_n$, so
\noindent
\begin{minipage}{.45\textwidth}
\small
\begin{align*}
X(\FF_q) &= q^m \\
X(\FF_{q^2}) &= (q^2)^m \\
&\vdots \\
X(\FF_{q^n}) &= q^{nm}
.\end{align*}
   \normalsize
\end{minipage}
\begin{minipage}{.45\textwidth}
   \centering
    \includegraphics[width = .5\linewidth]{figures/image_2020-04-23-00-21-46.png}
\captionof{figure}{$\AA^2 / \FF_3 ~(q=3, m = 2, n = 1)$}
\end{minipage}

Then
\small
\begin{align*}
Z_X(z) 
&= \exp\qty{\sum_{n=1}^\infty q^{nm} {z^n \over n} }  
= \exp\qty{\sum_{n=1}^\infty {\qty{q^m z}^n \over n} }  \\
&= \exp(-\log(1 - q^mz)) \\
&= \frac 1 {1 - q^mz}
.\end{align*}
\normalsize

## Example: Projective Line

Take $X = \PP^1/\FF$, we can still count by enumerating coordinates:
\small
\begin{align*}
\PP^1(\FF_{q^n}) 
&= \theset{[x_1: x_2] \suchthat x_1, x_2 \neq 0 \in \FF_{q^n}}/\sim  
~= \theset{[x_1: 1] \suchthat x_1 \in \FF_{q^n}} \disjoint \theset{[1: 0]}
.\end{align*}
\normalsize

Thus

\noindent
\begin{minipage}{.45\textwidth}
\small
    \begin{align*}
    X(\FF_q) &= q + 1\\
    X(\FF_{q^2}) &= q^2 + 1 \\
    &\vdots \\
    X(\FF_{q^n}) &= q^n + 1
    .\end{align*}
    \normalsize
\end{minipage}
\begin{minipage}{.45\textwidth}
   \centering
    \includegraphics[width = .5\linewidth]{figures/image_2020-04-23-00-07-42.png}
\captionof{figure}{$\PP^1 / \FF_3 ~(q=3, n = 1)$}
\end{minipage}

Thus
\small
\begin{align*}
Z_X(z) 
&= \exp\qty{\sum_{n=1}^\infty \qty{q^n + 1} {z^n \over n} }  \\
&= \exp\qty{\sum_{n=1}^\infty {q^n } {z^n \over n} + \sum_{n=1}^\infty 1 \cdot {z^n \over n}}\\
&= {1 \over (1-qz)(1-z)}
.\end{align*}
\normalsize


# The Weil Conjectures

## Statement of Weil Conjectures

(Weil 1949)

Let $X$ be a smooth projective variety of dimension $N$ over $\FF_{q}$ for $q$ a prime,  let $Z_X(z)$ be its zeta function, and define $\zeta_X(s) = Z_X(q^{-s})$. 


1. (Rationality) 

    $Z_X(z)$ is a rational function:

    \begin{align*}
    Z_X(z) &= 
    {p_1(z) \cdot p_3(z) \cdots p_{2N-1}(z) 
    \over 
    p_0(z) \cdot p_2(z) \cdots p_{2N}(z)} \in \QQ(z),\quad\text{i.e. }\quad p_i(z) \in \ZZ[z] \\ \\
    P_0(z) &= 1-z \\
    P_{2N}(z) &= 1 - q^N z \\
    P_j(z) &= \prod_{j=1}^{\beta_i} \qty{1 - a_{j, k} z} \qtext{for some reciprocal roots} a_{j, k} \in \CC
    \end{align*}
    where we've factored each $P_i$ using its reciprocal roots $a_{ij}$.

    In particular, this implies the existence of a meromorphic continuation of the associated function $\zeta_X(s)$, which a priori only converges for $\Re(s)\gg 0$.
    This also implies that for $n$ large enough, $N_n$ satisfies a linear recurrence relation.

2. (Functional Equation and Poincare Duality) 

    Let $\chi(X)$ be the Euler characteristic of $X$, i.e. the self-intersection number of the diagonal embedding $\Delta \injects X\cross X$; then $Z_X(z)$ satisfies the following *functional equation*:

    \begin{align*}
    Z_X\qty{1 \over q^N z} = \pm \qty{q^{N \over 2} z}^{\chi(X)} ~~Z_X(z)
    .\end{align*}

    Equivalently,
    \begin{align*}
    \zeta_X(N-s) = \pm \qty{q^{\frac N 2 - s}}^{\chi(X)} ~\zeta_X(s) \\
    .\end{align*}

    > Note that when $N=1$, e.g. for a curve, this relates $\zeta_X(s)$ to $\zeta_X(1-s)$.
  
    Equivalently, there is an involutive map on the (reciprocal) roots 
    \begin{align*}
    z &\iff {q^N \over z} \\
    \alpha_{j, k} &\iff \alpha_{2N-j, k}
    \end{align*}
    which sends roots of $p_j$ to roots of $p_{2N-j}$.

3. (Riemann Hypothesis)

  The reciprocal roots $a_{j,k}$ are *algebraic* integers (roots of some monic $p\in \ZZ[x]$) which satisfy 
  \begin{align*}
  \abs{a_{j,k}}_\CC = q^{j \over 2}  \quad\quad \forall 1 \leq j \leq 2N-1,~ \forall k
  .\end{align*}
  


4. (Betti Numbers)
  If $X$ is a "good reduction mod $q$" of a nonsingular projective variety $\tilde X$ in characteristic zero, then the $\beta_i = \deg p_i(z)$ are the Betti numbers of the topological space $\tilde X(\CC)$.



# Projective m-space

## Setup 

Take $X = \PP^m/\FF$ 
We can write 
$$
\PP^m(\FF_{q^n}) = \AA^{m+1}(\FF_{q^n}) \setminus \theset{\vector 0}/\sim ~= \theset{\vector x = [x_0, \cdots, x_m] \suchthat x_i \in \FF_{q^n}}/\sim
$$

But how many points are actually in this space?

\begin{figure}[h]
\caption{Points and Lines in $\PP^2/{\FF_3}$}
\centering
\includegraphics[width = 0.4\textwidth]{figures/image_2020-04-19-22-32-07.png} 
\end{figure}

> A nontrivial combinatorial problem!


## q-Analogs and Grassmannians 

To illustrate, this can be done combinatorially:
identify $\PP^m_\FF = \Gr_{\FF}(1, m+1)$ as the space of lines in $\AA^{m+1}_\FF$.

Theorem
:   The number of $k\dash$dimensional subspaces of $\AA^N_{\FF_q}$ is the $q\dash$analog of the binomial coefficient:
    \begin{align*}
    \genfrac{[}{]}{0pt}{}{N}{k}_q \definedas \frac{(q^N - 1)(q^{N-1}-1) \cdots (q^{N - (k-1)} -  1)}{(q^k-1)(q^{k-1} - 1) \cdots (q-1)}
    .\end{align*}

> Remark: Note $\lim_{q\to 1} \genfrac{[}{]}{0pt}{}{N}{k}_q = {N \choose k}$, the usual binomial coefficient.

**Proof:**  To choose a $k\dash$dimensional subspace, 
  
- Choose a nonzero vector $\vector v_1 \in \AA^n_\FF$ in $q^N - 1$ ways.
  - For next step, note that $\#\spanof\theset{\vector v_1} = \#\theset{\lambda \vector v_1 \suchthat \lambda \in \FF_q} = \# \FF_q = q$.
  
- Choose a nonzero vector $\vector v_2$ *not* in the span of $\vector v_1$ in $q^N - q$ ways.
  - Now note $\# \spanof\theset{\vector v_1, \vector v_2} = \# \theset{\lambda_1 \vector v_1 + \lambda_2 \vector v_2 \suchthat \lambda_i \in \FF} = q\cdot q = q^2$.

## Proof continued

- Choose a nonzero vector $\vector v_3$ *not* in the span of $\vector v_1, \vector v_2$ in $q^N -q^2$ ways.

- $\cdots$ until $\vector v_k$ is chosen in $$(q^N-1)(q^N-q) \cdots (q^N - q^{k-1}) \qtext{ways}$$. 
  - This yields a $k\dash$tuple of linearly independent vectors spanning a $k\dash$dimensional subspace $V_k$

- This overcounts because many linearly independent sets span $V_k$,  we need to divide out by the number of ways to choose a basis inside of $V_k$.

- By the same argument, this is given by $$(q^k-1)(q^k-q) \cdots (q^k - q^{k-1})$$ 


Thus
\small
\begin{align*}
\# \text{subspaces} 
&= \frac{ (q^N-1)(q^N-q)(q^N - q^2) \cdots (q^N - q^{k-1}) }{ (q^k-1)(q^k-q)(q^k-q^2) \cdots (q^k - q^{k-1})}\\ \\
&= {q^N - 1 \over q^k - 1} \cdot \qty{q \over q} {q^{N-1} - 1 \over q^{k-1} - 1} \cdot \qty{q^2 \over q^2}{q^{N-2} - 1 \over q^{k-2} - 1} \cdots \qty{q^{k-1} \over q^{k-1}}{q^{N - (k-1)} - 1 \over q^{k - (k-1) - 1}} \\ 
&= \frac{(q^N - 1)(q^{N-1}-1) \cdots (q^{N - (k-1)} -  1)}{(q^k-1)(q^{k-1} - 1) \cdots (q-1)}
.\end{align*}
\normalsize

$\qed$

## Counting Points 

Note that we've actually computed the number of points in any Grassmannian.

Identify $\PP^m_\FF = \Gr_{\FF}(1, m+1)$ as the space of lines in $\AA^{m+1}_\FF$.

We obtain a nice simplification for the number of lines corresponding to setting $k=1$:
\begin{align*}
\genfrac{[}{]}{0pt}{}{m+1 }{1}_q = {q^{m+1}-1 \over q - 1} = q^{m} + q^{m-1} + \cdots + q + 1 = \sum_{j=0}^{m} q^j
.\end{align*}

Thus
\begin{align*}
X(\FF_q) &= \sum_{j=0}^{m} q^j  \\
X(\FF_{q^2}) &= \sum_{j=0}^{m} \qty{q^2}^j  \\
&\vdots \\
X(\FF_{q^n}) &= \sum_{j=0}^{m} \qty{q^n}^j
.\end{align*}

## Computing the Zeta Function 

So
\begin{align*}
Z_X(z) 
&= \exp\qty{ \sum_{n=1}^\infty \sum_{j=0}^{m} \qty{q^n}^j {z^n \over n} } \\
&= \exp\qty{ \sum_{n=1}^\infty \sum_{j=0}^{m} {\qty{q^jz}^n \over n} } \\
&= \exp\qty{ \sum_{j=0}^{m} \sum_{n=1}^\infty {\qty{q^jz}^n \over n} } \\
&= \exp\qty{ \sum_{j=0}^{m-1} -\log(1 - q^j z) } \\
&= \prod_{j=0}^{m} \qty{1-q^jz}\inv \\
&=
\qty{1 \over 1 - z} \qty{1 \over 1 - qz} \qty{1 \over 1 - q^2 z} \cdots \qty{1 \over 1- q^m z}
,\end{align*}

> Miraculously, still a rational function!


## An Easier Proof 

Quick recap:
\begin{align*}
Z_{\pt} = {1 \over 1 - z} && Z_{\PP^1}(z) = {1 \over 1 - qz} && Z_{\AA^1}(z) = {1\over (1-z)(1-qz)}
.\end{align*}

Note that $\PP^1 = \AA^1 \disjoint \theset{\infty}$ and correspondingly $Z_{\PP^1}(z) = Z_{\AA^1}(z) \cdot Z_{\pt}(z)$.
This works in general:

Lemma (Excision)
: If $Y/\FF_q \subset X/\FF_q$ is a closed subvariety, for $U = X\setminus Y$, $Z_X(z) = Z_Y(z) \cdot Z_{U}(z)$.

**Proof**:
Let $N_n = \# Y(\FF_{q^n})$ and $M_n = \# U(\FF_{q^n})$, then
\begin{align*}
\zeta_X(z) 
&= \exp\qty{\sum_{n=1}^\infty \qty{N_n + M_n} {z^n \over n} }  \\
&= \exp\qty{\sum_{n=1}^\infty N_n \cdot {z^n \over n} + \sum_{n=1}^\infty M_n \cdot {z^n \over n}}\\
&= \exp\qty{\sum_{n=1}^\infty N_n \cdot {z^n \over n}} \cdot \exp\qty{\sum_{n=1}^\infty M_n \cdot {z^n \over n}}
= \zeta_Y(z) \cdot \zeta_U(z)
.\end{align*}


## A Easier Proof 

Note that geometry can help us here: we have a stratification $\PP^n = \PP^{n-1} \disjoint \AA^n$, and so inductively
\begin{align*}
\PP^m = \disjoint_{j=0}^m \AA^j = \AA^0 \disjoint \AA^1 \disjoint \cdots \disjoint \AA^m
,\end{align*}

and recalling that 
$$
Z_{X\disjoint Y}(z) = Z_X(z) \cdot Z_Y(z)
$$

and $Z_{\AA^j}(z) = {1 \over 1 - q^j z}$ we have
\begin{align*}
Z_{\PP^m}(z) = \prod_{j=0}^m Z_{\AA^j}(z) = \prod_{j=0}^m {1 \over 1 - q^j z}
.\end{align*}

> Notice that the highest degree is exactly $m$, and there is exactly one factor for each $j\leq m$.
> Note that $PP^m/\FF_q$ can be though of as a mod $q$ reduction of $\RP^m$ or $\CP^m$, and somehow $Z$ "sees" its dimension.

# Grassmannian 

## Motivation

Consider now $X = \Gr(k, m) / \FF$ -- by the previous computation, we know
\begin{align*}
X(\FF_{q^n}) = 
\genfrac{[}{]}{0pt}{}{m}{k}_{q^n} \definedas \frac{(q^{nm} - 1)(q^{{nm}-1}-1) \cdots (q^{{nm} - n(k-1)} -  1)}{(q^{nk}-1)(q^{n(k-1)} - 1) \cdots (q^n-1)}
\end{align*}

but the corresponding Zeta function is much more complicated than the previous examples:
\begin{align*}
Z_X(z) &= \exp\qty{ \sum_{n=1}^\infty \genfrac{[}{]}{0pt}{}{m}{k}_{q^n}   {z^n \over n} } = \cdots ?
.\end{align*}

Note that $\dim_\RR \Gr_\RR (k, m) = k(m-k)$ as a real manifold, so 



